<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>杂记 | STAR</title><meta name="keywords" content="烂笔头"><meta name="author" content="stardust,邮箱"><meta name="copyright" content="stardust"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="单片机部分    Stm32_Clock_Init(360,25,2,8);   &#x2F;&#x2F;设置时钟,180Mhz   对应的函数：Stm32_Clock_Init(u32 plln,u32 pllm,u32 pllp,u32 pllq)   &#x2F;&#x2F;plln:主PLL倍频系数(PLL倍频),取值范围:64~432.&#x2F;&#x2F;pllm:主PLL和音频PLL分频系数(PLL之前的分频),取值范围:2~63.&#x2F;&#x2F;pl">
<meta property="og:type" content="article">
<meta property="og:title" content="杂记">
<meta property="og:url" content="http://stardust14.com/2021/11/04/%E6%9D%82%E8%AE%B0/index.html">
<meta property="og:site_name" content="STAR">
<meta property="og:description" content="单片机部分    Stm32_Clock_Init(360,25,2,8);   &#x2F;&#x2F;设置时钟,180Mhz   对应的函数：Stm32_Clock_Init(u32 plln,u32 pllm,u32 pllp,u32 pllq)   &#x2F;&#x2F;plln:主PLL倍频系数(PLL倍频),取值范围:64~432.&#x2F;&#x2F;pllm:主PLL和音频PLL分频系数(PLL之前的分频),取值范围:2~63.&#x2F;&#x2F;pl">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/stardust14/picture/img/test010.png">
<meta property="article:published_time" content="2021-11-04T02:30:15.000Z">
<meta property="article:modified_time" content="2021-11-19T09:45:17.532Z">
<meta property="article:author" content="stardust">
<meta property="article:tag" content="烂笔头">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/stardust14/picture/img/test010.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/stardust14/picture/img/blogstar.png"><link rel="canonical" href="http://stardust14.com/2021/11/04/%E6%9D%82%E8%AE%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-19 17:45:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/stardust14/CDN/HexoStatic/css/newboth.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/stardust14/CDN/HexoStatic/css/hideCategory.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/stardust14/CDN/HexoStatic/css/scrollBar.css"><link rel="stylesheet" href="/css/mouse.css"><link rel="stylesheet" href="/css/icon.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/atom.xml" title="STAR" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/images/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 放松一下</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/photograph"><i class="fa-fw fa fa-globe"></i><span> Photograph</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 专栏</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/pdf/"><i class="fa-fw fa fa-file-pdf"></i><span> pdf</span></a></li><li><a class="site-page child" href="/%E9%9A%8F%E7%AC%94"><i class="fa-fw fas fa-pencil-alt"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于me</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/stardust14/picture/img/test010.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">STAR</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 放松一下</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/photograph"><i class="fa-fw fa fa-globe"></i><span> Photograph</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 专栏</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/pdf/"><i class="fa-fw fa fa-file-pdf"></i><span> pdf</span></a></li><li><a class="site-page child" href="/%E9%9A%8F%E7%AC%94"><i class="fa-fw fas fa-pencil-alt"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于me</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">杂记<a class="post-edit-link" href="null_posts/杂记.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-11-04T02:30:15.000Z" title="发表于 2021-11-04 10:30:15">2021-11-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-11-19T09:45:17.532Z" title="更新于 2021-11-19 17:45:17">2021-11-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%B0%E5%BD%95-%E7%83%82%E7%AC%94%E5%A4%B4/">记录&amp;烂笔头</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>25分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="杂记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>单片机部分</h1>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">   Stm32<span class="emphasis">_Clock_</span>Init(360,25,2,8);   //设置时钟,180Mhz</span><br><span class="line">   对应的函数：Stm32<span class="emphasis">_Clock_</span>Init(u32 plln,u32 pllm,u32 pllp,u32 pllq)</span><br><span class="line">   //plln:主PLL倍频系数(PLL倍频),取值范围:64~432.</span><br><span class="line">//pllm:主PLL和音频PLL分频系数(PLL之前的分频),取值范围:2~63.</span><br><span class="line">//pllp:系统时钟的主PLL分频系数(PLL之后的分频),取值范围:2,4,6,8.(仅限这4个值!)</span><br><span class="line">//pllq:USB/SDIO/随机数产生器等的主PLL分频系数(PLL之后的分频),取值范围:2~15.</span><br><span class="line">相当于生成了两个时钟，一个是180MHz的高速系统时钟，另一个是45MHz的用于USBUSB/SDIO/随机数产生器等的时钟</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">stm32f429的颜色库（<span class="number">14</span>种颜色）</span><br><span class="line">    <span class="comment">//画笔颜色</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WHITE         	 0xFFFF</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLACK         	 0x0000	  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLUE         	 0x001F  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRED             0XF81F</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GRED 			 0XFFE0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GBLUE			 0X07FF</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RED           	 0xF800</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAGENTA       	 0xF81F</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GREEN         	 0x07E0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CYAN          	 0x7FFF</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> YELLOW        	 0xFFE0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BROWN 			 0XBC40 <span class="comment">//棕色</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRRED 			 0XFC07 <span class="comment">//棕红色</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GRAY  			 0X8430 <span class="comment">//灰色</span></span></span><br></pre></td></tr></table></figure>
<p>遥控按键对应的码值</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">一种遥控器按键			</span><br><span class="line">			<span class="keyword">case</span> <span class="number">162</span>:str=<span class="string">&quot;POWER&quot;</span>;<span class="keyword">break</span>;	    </span><br><span class="line">			<span class="keyword">case</span> <span class="number">98</span>:str=<span class="string">&quot;Mode&quot;</span>;<span class="keyword">break</span>;	    </span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:	str=<span class="string">&quot;LEFT&quot;</span>;<span class="keyword">break</span>;		 </span><br><span class="line">			<span class="keyword">case</span> <span class="number">226</span>:str=<span class="string">&quot;MUTE&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">			<span class="keyword">case</span> <span class="number">194</span>:str=<span class="string">&quot;RIGHT&quot;</span>;<span class="keyword">break</span>;	   </span><br><span class="line">			<span class="keyword">case</span> <span class="number">34</span>:str=<span class="string">&quot;PAUSE&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">			<span class="keyword">case</span> <span class="number">224</span>:str=<span class="string">&quot;EQ&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">			<span class="keyword">case</span> <span class="number">168</span>:str=<span class="string">&quot;VOL-&quot;</span>;<span class="keyword">break</span>;		   </span><br><span class="line">			<span class="keyword">case</span> <span class="number">144</span>:str=<span class="string">&quot;VOL+&quot;</span>;<span class="keyword">break</span>;		    </span><br><span class="line">			<span class="keyword">case</span> <span class="number">104</span>:str=<span class="string">&quot;0&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">			<span class="keyword">case</span> <span class="number">152</span>:str=<span class="string">&quot;RPT&quot;</span>;<span class="keyword">break</span>;	   </span><br><span class="line">			<span class="keyword">case</span> <span class="number">176</span>:str=<span class="string">&quot;U/SD&quot;</span>;<span class="keyword">break</span>;	    </span><br><span class="line">			<span class="keyword">case</span> <span class="number">48</span>:str=<span class="string">&quot;1&quot;</span>;<span class="keyword">break</span>;		    </span><br><span class="line">			<span class="keyword">case</span> <span class="number">24</span>:str=<span class="string">&quot;2&quot;</span>;<span class="keyword">break</span>;		    </span><br><span class="line">			<span class="keyword">case</span> <span class="number">122</span>:str=<span class="string">&quot;3&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">			<span class="keyword">case</span> <span class="number">16</span>:str=<span class="string">&quot;4&quot;</span>;<span class="keyword">break</span>;			   					</span><br><span class="line">			<span class="keyword">case</span> <span class="number">56</span>:str=<span class="string">&quot;5&quot;</span>;<span class="keyword">break</span>;	 </span><br><span class="line">			<span class="keyword">case</span> <span class="number">90</span>:str=<span class="string">&quot;6&quot;</span>;<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">66</span>:str=<span class="string">&quot;7&quot;</span>;<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">74</span>:str=<span class="string">&quot;8&quot;</span>;<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">82</span>:str=<span class="string">&quot;9&quot;</span>;<span class="keyword">break</span>;	</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">正点原子配套的遥控器按键对应键值：	</span><br><span class="line">				<span class="keyword">case</span> <span class="number">162</span>:str=<span class="string">&quot;POWER&quot;</span>;<span class="keyword">break</span>;	    </span><br><span class="line">				<span class="keyword">case</span> <span class="number">98</span>:str=<span class="string">&quot;UP&quot;</span>;<span class="keyword">break</span>;	    </span><br><span class="line">				<span class="keyword">case</span> <span class="number">2</span>:str=<span class="string">&quot;PLAY&quot;</span>;<span class="keyword">break</span>;		 </span><br><span class="line">				<span class="keyword">case</span> <span class="number">226</span>:str=<span class="string">&quot;ALIENTEK&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">				<span class="keyword">case</span> <span class="number">194</span>:str=<span class="string">&quot;RIGHT&quot;</span>;<span class="keyword">break</span>;	   </span><br><span class="line">				<span class="keyword">case</span> <span class="number">34</span>:str=<span class="string">&quot;LEFT&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">				<span class="keyword">case</span> <span class="number">224</span>:str=<span class="string">&quot;VOL-&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">				<span class="keyword">case</span> <span class="number">168</span>:str=<span class="string">&quot;DOWN&quot;</span>;<span class="keyword">break</span>;		   </span><br><span class="line">				<span class="keyword">case</span> <span class="number">144</span>:str=<span class="string">&quot;VOL+&quot;</span>;<span class="keyword">break</span>;		    </span><br><span class="line">				<span class="keyword">case</span> <span class="number">104</span>:str=<span class="string">&quot;1&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">				<span class="keyword">case</span> <span class="number">152</span>:str=<span class="string">&quot;2&quot;</span>;<span class="keyword">break</span>;	   </span><br><span class="line">				<span class="keyword">case</span> <span class="number">176</span>:str=<span class="string">&quot;3&quot;</span>;<span class="keyword">break</span>;	    </span><br><span class="line">				<span class="keyword">case</span> <span class="number">48</span>:str=<span class="string">&quot;4&quot;</span>;<span class="keyword">break</span>;		    </span><br><span class="line">				<span class="keyword">case</span> <span class="number">24</span>:str=<span class="string">&quot;5&quot;</span>;<span class="keyword">break</span>;		    </span><br><span class="line">				<span class="keyword">case</span> <span class="number">122</span>:str=<span class="string">&quot;6&quot;</span>;<span class="keyword">break</span>;		  </span><br><span class="line">				<span class="keyword">case</span> <span class="number">16</span>:str=<span class="string">&quot;7&quot;</span>;<span class="keyword">break</span>;			   					</span><br><span class="line">				<span class="keyword">case</span> <span class="number">56</span>:str=<span class="string">&quot;8&quot;</span>;<span class="keyword">break</span>;	 </span><br><span class="line">				<span class="keyword">case</span> <span class="number">90</span>:str=<span class="string">&quot;9&quot;</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">66</span>:str=<span class="string">&quot;0&quot;</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">82</span>:str=<span class="string">&quot;DELETE&quot;</span>;<span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>
<p>枚举活用！！！</p>
<p>指针的用法：做底层操作系统（内存管理，消息队列），做模块化程序接口</p>
<p>指针和指针变量是两个概念，指针变量和普通变量一样，在使用前一定要定义和赋值，给指针变量赋的值和普通变量不同，给指针变量赋值只能赋地址，而不能赋予其他任何值，否则会引起错误。通过“&amp;”来获取普通变量的地址。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">数组与指针</span><br><span class="line">一般给数组分配连续的地址值</span><br><span class="line">指针变量 = &amp;数组名[下标] ----- p = &amp;buff[0]</span><br><span class="line">指针变量 = 数组名————  p = buff</span><br><span class="line"></span><br><span class="line"><span class="emphasis">*p=a的意思:将a的值赋给p指针指向的地址的值;</span></span><br><span class="line"><span class="emphasis">p=&amp;a的意思是:将a的地址赋给指针p;</span></span><br><span class="line"><span class="emphasis">区别:*</span>p是一个值;p是一个地址;两者完全不相同。</span><br><span class="line"><span class="emphasis">*是取内容，&amp;取地址</span></span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">指针自加自减运算</span><br><span class="line">指针变量除了可以用来获取内存地址的值以外，还可以用来进行加减运算，指针变量的加减是地址。</span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">指向指针的指针</span><br><span class="line">一个指针变量用于指向指针类型变量时，就称为指向指针的变量——————双重指针</span><br><span class="line">定义方法：</span><br><span class="line">数据类型 <span class="strong">**指针变量名</span></span><br><span class="line"><span class="strong">双重指针实际上最终指向的是上一层指针指向的变量值</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/stardust14/picture/img/20211109111457.png" alt=""></p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">指针变量作为函数形参</span><br><span class="line">目的是为了改变指针指向地址的值，专业术语是通过改变实参的值</span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">函数指针</span><br><span class="line">指向函数的指针：函数返回值类型(<span class="emphasis">*指针变量名)(函数参数列表)；</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">unsigned char (*</span>func)(unsigned char,unsigned char);</span><br><span class="line"></span><br><span class="line">unsigned char sum(unsigned char v1,unsigned char v2)&#123;</span><br><span class="line"><span class="code">	return v1+v2;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">int main()&#123;</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code">	unsigned char a;</span></span><br><span class="line"><span class="code">	func = sum;</span></span><br><span class="line"><span class="code">	a = func(1,2);</span></span><br><span class="line"><span class="code">	//a = (*func)(1,2);</span></span><br><span class="line"><span class="code">	printf(&quot;a=%d\r\n&quot;,a);</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">函数指针数组</span><br><span class="line">函数返回值类型(<span class="emphasis">*指针变量名[数组大小])(函数参数列表);</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">void func1();</span></span><br><span class="line"><span class="emphasis">void func2();</span></span><br><span class="line"><span class="emphasis">void func3();</span></span><br><span class="line"><span class="emphasis">unsigned char (*</span>func[3])()=&#123;func1,func2,func3&#125;;</span><br><span class="line"></span><br><span class="line">void func1()&#123;</span><br><span class="line"><span class="code">	printf(&quot;func1 running\r\n&quot;);</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">void func2()&#123;</span></span><br><span class="line"><span class="code">	printf(&quot;func2 running\r\n&quot;);</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">void func3()&#123;</span></span><br><span class="line"><span class="code">	printf(&quot;func3 running\r\n&quot;);</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">int main()&#123;</span></span><br><span class="line"><span class="code">	func[0]();</span></span><br><span class="line"><span class="code">	func[1]();</span></span><br><span class="line"><span class="code">	func[2]();</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//函数指针的用法举例</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> &#123;</span><br><span class="line">    LED1,</span><br><span class="line">    LED2,</span><br><span class="line">    LED3,</span><br><span class="line">    LED_SUM</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Drive_Led1</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> sta)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Drive_Led2</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> sta)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Drive_Led3</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> sta)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="title">char</span> <span class="params">(*func[LED_SUM])</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> sta)</span> </span>= &#123;Drive_Led1,Drive_Led2,Drive_Led3&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Drive_Led1</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> sta)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sta)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;LED1 ON\r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;LED1 OFF\r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Drive_Led2</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> sta)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sta)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;LED2 ON\r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;LED2 OFF\r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Drive_Led3</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> sta)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sta)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;LED3 ON\r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;LED3 OFF\r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    func[LED3](<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>结构体</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> 结构体名称</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    成员<span class="number">1</span>;</span><br><span class="line">    成员<span class="number">2</span>;</span><br><span class="line">    ···</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>   </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    成员<span class="number">1</span>;</span><br><span class="line">    成员<span class="number">2</span>;</span><br><span class="line">    ···</span><br><span class="line">&#125;结构体名称;</span><br><span class="line"></span><br><span class="line">结构体成员访问方法：结构体变量名.成员</span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">结构体数组</span><br><span class="line">1.直接用struct声明一个结构体，然后再定义结构体数组，定义格式：struct 结构体名称 数组名[数组大小]</span><br><span class="line"></span><br><span class="line">2.用typedef struct声明一个结构体，并且为结构体重命名，通过重命名的方式定义结构体数组。定义格式：结构体重命名 数组名[数组大小]</span><br><span class="line"></span><br><span class="line">结构体指针</span><br><span class="line">1.直接用struct声明一个结构体，然后再定义结构体指针，定义格式：struct 结构体名称 <span class="emphasis">*结构体指针变量名</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">2.用typedef struct声明一个结构体，并且为结构体重命名，通过别名的方式定义结构体数组。定义格式：结构体别名 *</span>结构体指针变量名</span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">包含结构体的结构体</span><br><span class="line">链表</span><br><span class="line"></span><br><span class="line">struct Student</span><br><span class="line">&#123;</span><br><span class="line"><span class="code">	unsigned char Name[20];</span></span><br><span class="line"><span class="code">	unsigned char number;</span></span><br><span class="line"><span class="code">	unsigned char sex;</span></span><br><span class="line"><span class="code">	struct Student *pLast;</span></span><br><span class="line"><span class="code">	struct Student *pNext;</span></span><br><span class="line"><span class="code">&#125;;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">int main()&#123;</span></span><br><span class="line"><span class="code">	unsigned char i;</span></span><br><span class="line"><span class="code">	struct Student Student4[4]=</span></span><br><span class="line"><span class="code">	&#123;</span></span><br><span class="line"><span class="code">		&#123;&quot;Stu1&quot;,1,&#x27;m&#x27;,0,0&#125;,</span></span><br><span class="line"><span class="code">		&#123;&quot;Stu2&quot;,2,&#x27;m&#x27;,0,0&#125;,</span></span><br><span class="line"><span class="code">		&#123;&quot;Stu3&quot;,3,&#x27;m&#x27;,0,0&#125;,</span></span><br><span class="line"><span class="code">		&#123;&quot;Stu4&quot;,4,&#x27;m&#x27;,0,0&#125;,</span></span><br><span class="line"><span class="code">	&#125;;</span></span><br><span class="line"><span class="code">	struct Student *pStu;</span></span><br><span class="line"><span class="code">	struct Student *pStud;</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code">	Student4[0].pNext = &amp;Student4[1];		//正向</span></span><br><span class="line"><span class="code">	Student4[1].pNext = &amp;Student4[2];</span></span><br><span class="line"><span class="code">	Student4[2].pNext = &amp;Student4[3];</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code">	Student4[3].pLast = &amp;Student4[2];		//反向</span></span><br><span class="line"><span class="code">	Student4[2].pLast = &amp;Student4[1];</span></span><br><span class="line"><span class="code">	Student4[1].pLast = &amp;Student4[0];</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code">	pStu = &amp;Student4[0];</span></span><br><span class="line"><span class="code">	pStud = &amp;Student4[3];</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code">	for(i=0;i&lt;4;i++)&#123;</span></span><br><span class="line"><span class="code">		printf(&quot;Name=%s,number = %d,sex = %c\r\n&quot;,pStu-&gt;Name,pStu-&gt;number,pStu-&gt;sex);</span></span><br><span class="line"><span class="code">		pStu = pStu-&gt;pNext;</span></span><br><span class="line"><span class="code">		</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">	printf(&quot;\r\n&quot;);</span></span><br><span class="line"><span class="code">	for(i=0;i&lt;4;i++)&#123;</span></span><br><span class="line"><span class="code">		printf(&quot;Name=%s,number = %d,sex = %c\r\n&quot;,pStud-&gt;Name,pStud-&gt;number,pStud-&gt;sex);</span></span><br><span class="line"><span class="code">		pStud = pStud-&gt;pLast;</span></span><br><span class="line"><span class="code">	&#125;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code"></span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/stardust14/picture/img/20211110104501.png" alt="链表"></p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">结构体和链表的实际应用</span><br><span class="line">黄金法则：只要是具备多种属性的任何东西，都可以用结构体来构造，这种东西可称之为对象。</span><br><span class="line"></span><br><span class="line">链表作用：</span><br><span class="line"></span><br><span class="line">静态链表：连接在一起的结构体变量数量是固定的，适用于一些固定好数量的数据结构。</span><br><span class="line"></span><br><span class="line">动态链表：通过动态分配内存的方式把结构体变量连接起来，这种结构体变量数量是未知的，会随着某种条件增加或减少结构体变量数量。比方说要接收串口的数据，如果串口一次性接收10个数据那么很好处理，直接定义一个数组，把大小设置成10.那如果不知道串口会传输多少个数据，比如说有可能一帧来100个，下一帧来1000个，那么用数组来进行存储就很不方便。所以就可以用动态链表的方式来实现。</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>队列</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">队列原理就像一个管道，如果不断往管道里塞乒乓球，每个乒乓球在管道里就会排成一条队列。先进去的乒乓球先出来，这就是队列的先进先出的规则。</span><br><span class="line">求从左边进去，进去的动作叫做“入列”，然后进去的球在管道里排成了一个队列，这个叫队列缓存也可以理解成数组，存入的5个球就相当于buff[5]；从右边出来的1号球是最早进去的球，这个动作叫出列，遵循先进先出的规则。</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/stardust14/picture/img/20211111093107.png" alt=""></p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">队列的作用</span><br><span class="line">队列最主要的作用是用来缓存数据，比如说串口接收数据，一般可以定义一个数组来存储数据，但是假如串口数据频率很快，可能这个数组里存储的数据还没处理完，下一组串口数据又过来了，那么这时候数组里的数据就会被新数据覆盖，导致老的数据丢失。像这种就可以通过队列的方式来处理，每收到一个字节数据都先入列，然后在应用程序同步解析处理，根据队列先进先出的规则，那么老的数据就不会被新的数据“插队”了。</span><br><span class="line">  </span><br><span class="line">应用场景：</span><br><span class="line">1.操作系统的消息传递</span><br><span class="line">2.大数据处理</span><br><span class="line"></span><br><span class="line">队列的3个核心关键点</span><br><span class="line">1.队列缓存</span><br><span class="line">2.入列</span><br><span class="line">3.出列</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">入列</span><br><span class="line"></span><br><span class="line">入列其实就是把数据存进数组的操作，但是在入队时要考虑2个问题：</span><br><span class="line">1.队列缓存可以存储的数组下标位置，一般称为队尾。</span><br><span class="line">2.队列是否已满，如果队列缓存满了又有新的数据入列，该怎么处理？一般处理方式是按照时间顺序，把最早入列的数据丢弃，以新的数据（就是最早入列的下一个数据）替换。</span><br><span class="line"></span><br><span class="line">用指针的特性，在用1个指针变量来代表队尾，然后这个队尾指针指向队列缓存数据的首地址，当入列1个数据时，队尾指针就加1，这样就可以知道当前队列缓存的存储的位置地址。</span><br><span class="line"></span><br><span class="line">出列</span><br><span class="line"></span><br><span class="line">数据出列的时候也是有原则的，从最早的入列那个数据的地址开始取，出列的数组下标称为队头，用指针变量来代表队头。</span><br><span class="line">下图为出列的流程，共有5个数据，队头指针指向队列缓存首地址，接着第一个出列的数据就是1，出列后队头指针加1，指向数据2的地址，那么数据2出列后，队头指针又加1，指向数据3的地址，以此类推，这样就可以实现先进先出的原则。</span><br><span class="line">注：同时队头指针和队尾指针在存储数据后，指针指向一般是不相等的。</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/stardust14/picture/img/20211117084859.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/stardust14/picture/img/20211117084849.png" alt=""></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">main.c</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Queue.h&quot;</span></span></span><br><span class="line">Queue4 KeyMsg;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> a; </span><br><span class="line">	QueueEmpty(KeyMsg);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;site:%d\r\n&quot;</span>,<span class="keyword">sizeof</span>(KeyMsg.Buff)); </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;KeyMsg=0x%x, KeyMsg.Buff=0x%x, KeyMsg.Head=0x%x, KeyMsg.Tail=0x%x\r\n&quot;</span>,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;buff[0]=0x%x, &amp;buff[1]=0x%x, &amp;buff[2]=0x%x, &amp;buff[3]=0x%x \r\n&quot;</span>,&amp;KeyMsg.Buff[<span class="number">0</span>],&amp;KeyMsg.Buff[<span class="number">1</span>],&amp;KeyMsg.Buff[<span class="number">2</span>],&amp;KeyMsg.Buff[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n&quot;</span>); </span><br><span class="line">	</span><br><span class="line">	a = <span class="number">1</span>;</span><br><span class="line">	QueueDataIn(KeyMsg,&amp;a,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;KeyMsg=0x%x, KeyMsg.Buff=0x%x, KeyMsg.Head=0x%x, KeyMsg.Tail=0x%x\r\n&quot;</span>,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;</span>,KeyMsg.Buff[<span class="number">0</span>],KeyMsg.Buff[<span class="number">1</span>],KeyMsg.Buff[<span class="number">2</span>],KeyMsg.Buff[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n&quot;</span>); </span><br><span class="line">	</span><br><span class="line">	a = <span class="number">2</span>;</span><br><span class="line">	QueueDataIn(KeyMsg,&amp;a,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, TestMsg.Tail=0x%x\r\n&quot;</span>,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;</span>,KeyMsg.Buff[<span class="number">0</span>],KeyMsg.Buff[<span class="number">1</span>],KeyMsg.Buff[<span class="number">2</span>],KeyMsg.Buff[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n&quot;</span>); </span><br><span class="line">	</span><br><span class="line">	a = <span class="number">3</span>;</span><br><span class="line">	QueueDataIn(KeyMsg,&amp;a,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, TestMsg.Tail=0x%x\r\n&quot;</span>,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;</span>,KeyMsg.Buff[<span class="number">0</span>],KeyMsg.Buff[<span class="number">1</span>],KeyMsg.Buff[<span class="number">2</span>],KeyMsg.Buff[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n&quot;</span>); </span><br><span class="line">	</span><br><span class="line"> a = <span class="number">4</span>;</span><br><span class="line">	QueueDataIn(KeyMsg,&amp;a,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, TestMsg.Tail=0x%x\r\n&quot;</span>,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;</span>,KeyMsg.Buff[<span class="number">0</span>],KeyMsg.Buff[<span class="number">1</span>],KeyMsg.Buff[<span class="number">2</span>],KeyMsg.Buff[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n&quot;</span>); </span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	 a = <span class="number">5</span>;</span><br><span class="line">	QueueDataIn(KeyMsg,&amp;a,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, TestMsg.Tail=0x%x\r\n&quot;</span>,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;</span>,KeyMsg.Buff[<span class="number">0</span>],KeyMsg.Buff[<span class="number">1</span>],KeyMsg.Buff[<span class="number">2</span>],KeyMsg.Buff[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n&quot;</span>); </span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, KeyMsg.Tail=0x%x\r\n&quot;</span>,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span><br><span class="line">	QueueDataOut(KeyMsg,&amp;a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;a=%d\r\n&quot;</span>,a); </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, TestMsg.Tail=0x%x\r\n&quot;</span>,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;</span>,KeyMsg.Buff[<span class="number">0</span>],KeyMsg.Buff[<span class="number">1</span>],KeyMsg.Buff[<span class="number">2</span>],KeyMsg.Buff[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\r\n&quot;</span>); </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//QueueEmpty(KeyMsg);</span></span><br><span class="line"><span class="comment">//	printf(&quot;site:%d\r\n&quot;,sizeof(KeyMsg.Buff)); </span></span><br><span class="line"><span class="comment">//	printf(&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, KeyMsg.Tail=0x%x\r\n&quot;,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span></span><br><span class="line"><span class="comment">//	printf(&quot;&amp;buff[0]=0x%x, &amp;buff[1]=0x%x, &amp;buff[2]=0x%x, &amp;buff[3]=0x%x \r\n&quot;,&amp;KeyMsg.Buff[0],&amp;KeyMsg.Buff[1],&amp;KeyMsg.Buff[2],&amp;KeyMsg.Buff[3]);</span></span><br><span class="line"><span class="comment">//	printf(&quot;\r\n&quot;); </span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//	</span></span><br><span class="line"><span class="comment">//	a = 1;</span></span><br><span class="line"><span class="comment">//	QueueDataIn(KeyMsg,&amp;a,1);</span></span><br><span class="line"><span class="comment">//	printf(&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, TestMsg.Tail=0x%x\r\n&quot;,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span></span><br><span class="line"><span class="comment">//	printf(&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;,KeyMsg.Buff[0],KeyMsg.Buff[1],KeyMsg.Buff[2],KeyMsg.Buff[3]);</span></span><br><span class="line"><span class="comment">//	printf(&quot;\r\n&quot;); </span></span><br><span class="line"><span class="comment">//	</span></span><br><span class="line"><span class="comment">//	a = 2;</span></span><br><span class="line"><span class="comment">//	QueueDataIn(KeyMsg,&amp;a,1);</span></span><br><span class="line"><span class="comment">//	printf(&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, TestMsg.Tail=0x%x\r\n&quot;,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span></span><br><span class="line"><span class="comment">//	printf(&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;,KeyMsg.Buff[0],KeyMsg.Buff[1],KeyMsg.Buff[2],KeyMsg.Buff[3]);</span></span><br><span class="line"><span class="comment">//	printf(&quot;\r\n&quot;); </span></span><br><span class="line"><span class="comment">//	</span></span><br><span class="line"><span class="comment">//	</span></span><br><span class="line"><span class="comment">//	a = 3;</span></span><br><span class="line"><span class="comment">//	QueueDataIn(KeyMsg,&amp;a,1);</span></span><br><span class="line"><span class="comment">//	printf(&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, TestMsg.Tail=0x%x\r\n&quot;,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span></span><br><span class="line"><span class="comment">//	printf(&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;,KeyMsg.Buff[0],KeyMsg.Buff[1],KeyMsg.Buff[2],KeyMsg.Buff[3]);</span></span><br><span class="line"><span class="comment">//	printf(&quot;\r\n&quot;); </span></span><br><span class="line"><span class="comment">//	</span></span><br><span class="line"><span class="comment">//	</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//	</span></span><br><span class="line"><span class="comment">//	a = 5;</span></span><br><span class="line"><span class="comment">//	printf(&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, KeyMsg.Tail=0x%x\r\n&quot;,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span></span><br><span class="line"><span class="comment">//	QueueDataOut(KeyMsg,&amp;a);</span></span><br><span class="line"><span class="comment">//	printf(&quot;a=%d\r\n&quot;,a); </span></span><br><span class="line"><span class="comment">//	//printf(&quot;&amp;TestMsg=0x%x, TestMsg.Buff=0x%x, TestMsg.Head=0x%x, TestMsg.Tail=0x%x\r\n&quot;,&amp;KeyMsg,KeyMsg.Buff,KeyMsg.Head,KeyMsg.Tail);</span></span><br><span class="line"><span class="comment">//	//printf(&quot;buff[0]=0x%x, buff[1]=0x%x, buff[2]=0x%x, buff[3]=0x%x \r\n&quot;,KeyMsg.Buff[0],KeyMsg.Buff[1],KeyMsg.Buff[2],KeyMsg.Buff[3]);</span></span><br><span class="line"><span class="comment">//	//printf(&quot;\r\n&quot;); </span></span><br><span class="line"><span class="comment">//		 </span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Queue.h</span><br><span class="line">    </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _QUEUE_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _QUEUE_H_</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">S_QueueEmpty</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> **Head,<span class="keyword">unsigned</span> <span class="keyword">char</span> **Tail,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pBuff)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">S_QueueDataIn</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> **Head,<span class="keyword">unsigned</span> <span class="keyword">char</span> **Tail,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pBuff,<span class="keyword">unsigned</span> <span class="keyword">char</span> Len,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pData,<span class="keyword">unsigned</span> <span class="keyword">char</span> DataLen)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">S_QueueDataOut</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> **Head,<span class="keyword">unsigned</span> <span class="keyword">char</span> **Tail,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pBuff,<span class="keyword">unsigned</span> <span class="keyword">char</span> Len,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pData)</span></span>; </span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="title">S_QueueDataLen</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> **Head,<span class="keyword">unsigned</span> <span class="keyword">char</span> **Tail,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pBuff,<span class="keyword">unsigned</span> <span class="keyword">char</span> Len)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> QueueEmpty(x)  S_QueueEmpty((unsigned char **)&amp;(x).Head,(unsigned char **)&amp;(x).Tail,(unsigned char *)(x).Buff)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> QueueDataIn(x,y,z) S_QueueDataIn((unsigned char **)&amp;(x).Head,(unsigned char **)&amp;(x).Tail,(unsigned char *)&amp;(x).Buff,sizeof((x).Buff),y,z)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> QueueDataOut(x,y)  S_QueueDataOut((unsigned char **)&amp;(x).Head,(unsigned char **)&amp;(x).Tail,(unsigned char *)&amp;(x).Buff,sizeof((x).Buff),y)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> QueueDataLen(x) 	S_QueueDataLen((unsigned char **)&amp;(x).Head,(unsigned char **)&amp;(x).Tail,(unsigned char *)&amp;(x).Buff,sizeof((x).Buff))</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> *Head; 	<span class="comment">//队头指针，用来出列用的 </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> *Tail; 	<span class="comment">//队尾指针，用来入列用的 </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> Buff[<span class="number">4</span>];	<span class="comment">//队列缓存 </span></span><br><span class="line">&#125;Queue4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> *Head; 	<span class="comment">//队头指针，用来出列用的 </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> *Tail; 	<span class="comment">//队尾指针，用来入列用的 </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> Buff[<span class="number">128</span>];	<span class="comment">//队列缓存 </span></span><br><span class="line">&#125;Queue128;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> *Head; 	<span class="comment">//队头指针，用来出列用的 </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> *Tail; 	<span class="comment">//队尾指针，用来入列用的 </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> Buff[<span class="number">512</span>];	<span class="comment">//队列缓存 </span></span><br><span class="line">&#125;Queue512;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">Queue.c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">S_QueueEmpty</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> **Head,<span class="keyword">unsigned</span> <span class="keyword">char</span> **Tail,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pBuff)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	*Head = pBuff;</span><br><span class="line">	*Tail = pBuff; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">S_QueueDataIn</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> **Head,<span class="keyword">unsigned</span> <span class="keyword">char</span> **Tail,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pBuff,<span class="keyword">unsigned</span> <span class="keyword">char</span> Len,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pData,<span class="keyword">unsigned</span> <span class="keyword">char</span> DataLen)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> num;</span><br><span class="line">	<span class="comment">//关闭中断 </span></span><br><span class="line">	<span class="keyword">for</span>(num=<span class="number">0</span>; num &lt; DataLen; num++,pData++)</span><br><span class="line">	&#123;	</span><br><span class="line">		**Tail = *pData;		<span class="comment">//这里把数据入列 </span></span><br><span class="line">		(*Tail)++;				<span class="comment">//队尾指针加1</span></span><br><span class="line">	 	<span class="keyword">if</span>(*Tail == pBuff+Len)</span><br><span class="line">	 	&#123;</span><br><span class="line">	 		*Tail = pBuff; </span><br><span class="line">	 	&#125;</span><br><span class="line">		<span class="keyword">if</span>(*Tail == *Head)</span><br><span class="line">		&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(++(*Head) == pBuff+Len)</span><br><span class="line">			&#123;</span><br><span class="line">				*Head = pBuff;	</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//打开中断 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">S_QueueDataOut</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> **Head,<span class="keyword">unsigned</span> <span class="keyword">char</span> **Tail,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pBuff,<span class="keyword">unsigned</span> <span class="keyword">char</span> Len,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pData)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> status;</span><br><span class="line">	<span class="comment">//关闭中断 </span></span><br><span class="line">	status = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(*Head != *Tail)</span><br><span class="line">	&#123;</span><br><span class="line">		*pData = **Head;</span><br><span class="line">		status = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(++(*Head) == pBuff+Len)</span><br><span class="line">		&#123;</span><br><span class="line">			*Head = pBuff;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//恢复中断 </span></span><br><span class="line">	<span class="keyword">return</span> status;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="title">S_QueueDataLen</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> **Head,<span class="keyword">unsigned</span> <span class="keyword">char</span> **Tail,<span class="keyword">unsigned</span> <span class="keyword">char</span> *pBuff,<span class="keyword">unsigned</span> <span class="keyword">char</span> Len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(*Tail &gt; *Head)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> *Tail-*Head;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(*Tail &lt; *Head)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> *Tail+Len-*Head;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>回调函数</li>
</ul>
<p>要求：硬件层和应用层的程序代码分开，相互之间的控制和通讯使用接口，而且不会共享的共享的全局变量或数组。（可移植性，可扩展性）</p>
<p>核心作用：</p>
<ol>
<li>把数据从一个.c文件传递到另一个.c文件中，而不用全局变量共享数据</li>
<li>对于这种数据传递方式，回调函数更利于代码的封装。</li>
</ol>
<p>模拟按键检测</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//main.c</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;key.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KeyScanHandle</span><span class="params">(KEY_ID_TYPEDEF KeyID,KEY_STATE_TYPEDEF KeyState)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(KeyID == KEY2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(KeyState == KEY_PRESS)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;KeyID = %d,KeyState = %d\r\n&quot;</span>,KeyID,KeyState);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    KeyInit();</span><br><span class="line">    KeyScanSBSRegister(KeyScanHandle);</span><br><span class="line">    KeyPoll();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//key.c</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;key.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">KEY_ID_TYPEDEF keyVal;		<span class="comment">//按键ID</span></span><br><span class="line">KEY_STATE_TYPEDEF keyState;		</span><br><span class="line"></span><br><span class="line">pKeyScanCallBack pKeyScanCBS;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KeyInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    keyVal = <span class="number">0</span>;</span><br><span class="line">    KeyState = Key_IDLE;</span><br><span class="line">    pKeyScanCBS = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KeyScanSBSRegister</span><span class="params">(pKeyScanCallBack pCBS)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pKeyScanCBS == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pKeyScanCBS = pCBS;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KeyPoll</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Please Enter key value:&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;keyVal)==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Please Enter key state:&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;keyState)==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(pKeyScanCBS != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">           		pKeyScanCBS(keyVal,keyState);		<span class="comment">//相当于KeyScanHandle(keyVal,keyState);</span></span><br><span class="line">            &#125;</span><br><span class="line">          </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//key.h</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _KEY_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _KEY_H_</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span></span><br><span class="line">&#123;</span><br><span class="line">    KEY1,</span><br><span class="line">    KEY2,</span><br><span class="line">&#125;KEY_ID_TYPEDEF;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span></span><br><span class="line">&#123;</span><br><span class="line">    KEY_IDLE,		<span class="comment">//空闲</span></span><br><span class="line">    KEY_PRESS,		<span class="comment">//按键短按</span></span><br><span class="line">    KEY_LOG_PRESS,	<span class="comment">//按键长按</span></span><br><span class="line">    KEY_PELEASE,	<span class="comment">//按键释放</span></span><br><span class="line">&#125;KEY_STATE_TYPEDEF;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*pKeyScanCallBack)</span><span class="params">(KEY_ID_TYPEDEF KeyID,KEY_STATE_TYPEDEF KeyState)</span></span>;		<span class="comment">//函数指针</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KeyInit</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KeyPoll</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">KeyScanSBSRegister</span><span class="params">(pKeyScanCallBack pCBS)</span></span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>程序架构内核</li>
</ul>
<ol>
<li>传统顺序执行的程序架构</li>
</ol>
<p>对于单片机程序的开发者来说，真正会使用架构的不多，碰到最多的就是在写单片机程序的时候都会使用while死循环然后按照顺序从上往下执行各种程序。这种方法程序设计比较简单。缺点：只适合做小项目，程序大了以后逻辑会非常混乱，实时性、稳定性、移植性差。</p>
<ol start="2">
<li>实时操作系统</li>
</ol>
<p>除了以上传统架构以外呢，还有另外一种稳定地架构，就是实时操作系统,比如ucOs、RTOS这些，这个架构内核帮用户完成了很多复杂地功能，如任务调度、任务通讯、内存管理、定时器、消息队列等等，用户无需关心架构底层实现方法，只需要能将系统移植好跑起来就行了。<br>
这种架构的优点是它自身就是一个稳定的、实时性高的、有些甚至提供了图形Guil和网络协议TCP/IP等强大的功能。<br>
缺点就是虽然很强大，但是由于占用内存资源比较严重，移植起来也比较复杂，应用后如果不去深耕系统架构的工作原理出了问题会无从下手.所以这种系统一般针对大型项目，对某些功能有需求的，比方说带屏的需要做大量界面的，或者带网络通讯的。</p>
<ol start="3">
<li>轻量级程序架构</li>
</ol>
<p>前面说的两种架构呢，第一个简单粗暴但是程序越大会让人摸不着头脑，第二个是实时性高稳定强大但是移植和使用都相对比较复杂，也非常占用单片机内存资源，程序执行的状态无法完全掌控。所以针对这两个架构的一些缺点，我们可以通过我们课程前面所学的一些c语言高级技巧配合实时操作系统的一些思维来做一个介于这2者之间的轻量级程序架构。那么这个程序架构的定位是能够应用大多数中低端单片机，所以要求程序本身占用单片机内存资源要少，在1KB左右。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">程序架构分成两个部分：</span><br><span class="line"></span><br><span class="line">1.程序架构系统内核</span><br><span class="line">2.任务调度</span><br><span class="line">系统内核用于任务的统一分配管理。</span><br><span class="line">任务通信就是不同模块间的通信，比如说硬件层和应用层数据传递，这个就是通过回调函数来实现。</span><br><span class="line">我们把这两个最核心的问题解决了，其他小问题就迎刃而解了，像什么延时，全局变量共享等问题。那为了能够适应更多的单片机，尽量做到51都能用，所以我们不会把程序架构设计的太复杂。该设计能够解决单片机产品开发一些刚性的需求，比如灵活的延时、不同区域的数据通信等。同时也满足移植性高，稳定性强，实时性好的特点。</span><br><span class="line"></span><br><span class="line">程序架构内核代码的实现原理：</span><br><span class="line">程序架构内核代码就是我们前面说的系统内核代码，主要是用来分配任务和任务调度的，任务就是各功能模块轮询的处理函数。</span><br><span class="line">分配任务就创建任务，把各功能模块处理函数加入到任务管理列表里。任务调度就是定时唤醒和休眠任务列表里的任务。</span><br><span class="line">这里的唤醒就是调用，休眠就是把任务挂起，不让它执行。</span><br></pre></td></tr></table></figure>
<p>程序架构的系统内核工作流程：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/stardust14/picture/img/20211118094657.png" alt=""></p>
<p>任务初始化:包含硬件的初始化，如GPIO的配置，定时器初始化，串口初始化等等。然后进行任务的创建和任务执行函数的初始化。<br>
任务调度:即我们传统的While(1)循环里面轮询的程序，只是我们通过一些C语言高级技巧把功能做的更灵活强大一些，并且能为每个任务提供不一样的时间节拍，还可以让任意一个任务进入休眠。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">系统内核说白了就是写一个任务的管理程序，通过这个程序可以更加灵活控制整个程序的运行状态，特别是对于需要做低功耗的产品来说。</span><br><span class="line">系统内核主要完成以下工作:</span><br><span class="line">1.任务创建</span><br><span class="line">2.任务调度</span><br><span class="line">3.任务挂起</span><br><span class="line">4.任务休眠</span><br><span class="line">优点:</span><br><span class="line">1.可以为每个任务提供不同时钟节拍。</span><br><span class="line">2.可以很灵活控制每个任务的执行状态。</span><br><span class="line">3.实时性更高。</span><br><span class="line">4.程序流程更加清晰。</span><br><span class="line">5.更适合做低功耗。</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```c</span><br></pre></td></tr></table></figure>
<h1>MATLAB</h1>
<table>
<thead>
<tr>
<th style="text-align:left">线型</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>-</code></td>
<td style="text-align:left">实线</td>
</tr>
<tr>
<td style="text-align:left"><code>--</code></td>
<td style="text-align:left">虚线</td>
</tr>
<tr>
<td style="text-align:left"><code>:</code></td>
<td style="text-align:left">点线</td>
</tr>
<tr>
<td style="text-align:left"><code>-.</code></td>
<td style="text-align:left">点划线</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">标记</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>'o'</code></td>
<td style="text-align:left">圆圈</td>
</tr>
<tr>
<td style="text-align:left"><code>'+'</code></td>
<td style="text-align:left">加号</td>
</tr>
<tr>
<td style="text-align:left"><code>'*'</code></td>
<td style="text-align:left">星号</td>
</tr>
<tr>
<td style="text-align:left"><code>'.'</code></td>
<td style="text-align:left">点</td>
</tr>
<tr>
<td style="text-align:left"><code>'x'</code></td>
<td style="text-align:left">叉号</td>
</tr>
<tr>
<td style="text-align:left"><code>'_'</code></td>
<td style="text-align:left">水平线条</td>
</tr>
<tr>
<td style="text-align:left"><code>'|'</code></td>
<td style="text-align:left">垂直线条</td>
</tr>
<tr>
<td style="text-align:left"><code>'s'</code></td>
<td style="text-align:left">方形</td>
</tr>
<tr>
<td style="text-align:left"><code>'d'</code></td>
<td style="text-align:left">菱形</td>
</tr>
<tr>
<td style="text-align:left"><code>'^'</code></td>
<td style="text-align:left">上三角</td>
</tr>
<tr>
<td style="text-align:left"><code>'v'</code></td>
<td style="text-align:left">下三角</td>
</tr>
<tr>
<td style="text-align:left"><code>'&gt;'</code></td>
<td style="text-align:left">右三角</td>
</tr>
<tr>
<td style="text-align:left"><code>'&lt;'</code></td>
<td style="text-align:left">左三角</td>
</tr>
<tr>
<td style="text-align:left"><code>'p'</code></td>
<td style="text-align:left">五角形</td>
</tr>
<tr>
<td style="text-align:left"><code>'h'</code></td>
<td style="text-align:left">六角形</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">颜色</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>y</code></td>
<td style="text-align:left">黄色</td>
</tr>
<tr>
<td style="text-align:left"><code>m</code></td>
<td style="text-align:left">品红色</td>
</tr>
<tr>
<td style="text-align:left"><code>c</code></td>
<td style="text-align:left">青蓝色</td>
</tr>
<tr>
<td style="text-align:left"><code>r</code></td>
<td style="text-align:left">红色</td>
</tr>
<tr>
<td style="text-align:left"><code>g</code></td>
<td style="text-align:left">绿色</td>
</tr>
<tr>
<td style="text-align:left"><code>b</code></td>
<td style="text-align:left">蓝色</td>
</tr>
<tr>
<td style="text-align:left"><code>w</code></td>
<td style="text-align:left">白色</td>
</tr>
<tr>
<td style="text-align:left"><code>k</code></td>
<td style="text-align:left">黑色</td>
</tr>
</tbody>
</table>
<blockquote>
<p><code>LineWidth</code> - 线条宽度 <code>0.5</code> （默认） | 正值</p>
<p><code>Color</code> - 针状图颜色 <code>[0 0 0]</code> （默认） | RGB 三元组 | 十六进制颜色代码 | <code>'r'</code> | <code>'g'</code> | <code>'b'</code> | …</p>
</blockquote>
<p><code>Marker</code> - 标记符号 <code>'o'</code> （默认） | <code>'+'</code> | <code>'*'</code> | <code>'.'</code> | <code>'x'</code> | …</p>
<table>
<thead>
<tr>
<th style="text-align:left">值</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>'o'</code></td>
<td style="text-align:left">圆圈</td>
</tr>
<tr>
<td style="text-align:left"><code>'+'</code></td>
<td style="text-align:left">加号</td>
</tr>
<tr>
<td style="text-align:left"><code>'*'</code></td>
<td style="text-align:left">星号</td>
</tr>
<tr>
<td style="text-align:left"><code>'.'</code></td>
<td style="text-align:left">点</td>
</tr>
<tr>
<td style="text-align:left"><code>'x'</code></td>
<td style="text-align:left">叉号</td>
</tr>
<tr>
<td style="text-align:left"><code>'_'</code></td>
<td style="text-align:left">水平线条</td>
</tr>
<tr>
<td style="text-align:left"><code>'|'</code></td>
<td style="text-align:left">垂直线条</td>
</tr>
<tr>
<td style="text-align:left"><code>'square'</code> 或 <code>'s'</code></td>
<td style="text-align:left">方形</td>
</tr>
<tr>
<td style="text-align:left"><code>'diamond'</code> 或 <code>'d'</code></td>
<td style="text-align:left">菱形</td>
</tr>
<tr>
<td style="text-align:left"><code>'^'</code></td>
<td style="text-align:left">上三角</td>
</tr>
<tr>
<td style="text-align:left"><code>'v'</code></td>
<td style="text-align:left">下三角</td>
</tr>
<tr>
<td style="text-align:left"><code>'&gt;'</code></td>
<td style="text-align:left">右三角</td>
</tr>
<tr>
<td style="text-align:left"><code>'&lt;'</code></td>
<td style="text-align:left">左三角</td>
</tr>
<tr>
<td style="text-align:left"><code>'pentagram'</code> 或 <code>'p'</code></td>
<td style="text-align:left">五角星（五角形）</td>
</tr>
<tr>
<td style="text-align:left"><code>'hexagram'</code> 或 <code>'h'</code></td>
<td style="text-align:left">六角星（六角形）</td>
</tr>
<tr>
<td style="text-align:left"><code>'none'</code></td>
<td style="text-align:left">无标记</td>
</tr>
</tbody>
</table>
<blockquote>
<p><code>MarkerSize</code> - 标记大小 <code>6</code> （默认） | 正值</p>
<p><code>MarkerEdgeColor</code> - 标记轮廓颜色 <code>'auto'</code> （默认） | RGB 三元组 | 十六进制颜色代码 | <code>'r'</code> | <code>'g'</code> | <code>'b'</code> | …</p>
</blockquote>
<h1>直达底部</h1>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:邮箱">stardust</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://stardust14.com/2021/11/04/%E6%9D%82%E8%AE%B0/">http://stardust14.com/2021/11/04/%E6%9D%82%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://stardust14.com" target="_blank">STAR</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%83%82%E7%AC%94%E5%A4%B4/">烂笔头</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/stardust14/picture/img/test010.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/"/></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/"/></a><div class="post-qr-code-desc"></div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2021/08/13/Android/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/stardust14/picture/img/saber1.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Android</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">单片机部分</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">MATLAB</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">直达底部</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/stardust14/picture/img/test010.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 - 2021 By stardust</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'HTNDsPzD87VFJzxigXr0LgQT-gzGzoHsz',
      appKey: 'rujMRAYTJMNb3muoM0nm6YCs',
      placeholder: '请留下你来过的痕迹吧~',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '//i0.hdslb.com/bfs/emote/',
      emojiMaps: {"[tv_白眼]":"c1d59f439e379ee50eef488bcb5e5378e5044ea4.png","[tv_doge]":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","[tv_坏笑]":"1f0b87f731a671079842116e0991c91c2c88645a.png","[tv_难过]":"87f46748d3f142ebc6586ff58860d0e2fc8263ba.png","[tv_生气]":"26702dcafdab5e8225b43ffd23c94ac1ff932654.png","[tv_委屈]":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","[tv_斜眼笑]":"911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png","[tv_呆]":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","[tv_发怒]":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","[tv_惊吓]":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png","[tv_呕吐]":"9f996894a39e282ccf5e66856af49483f81870f3.png","[tv_思考]":"90cf159733e558137ed20aa04d09964436f618a1.png","[tv_微笑]":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","[tv_疑问]":"0793d949b18d7be716078349c202c15ff166f314.png","[tv_大哭]":"23269aeb35f99daee28dda129676f6e9ea87934f.png","[tv_鼓掌]":"1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png","[tv_抠鼻]":"c666f55e88d471e51bbd9fab9bb308110824a6eb.png","[tv_亲亲]":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","[tv_调皮]":"b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png","[tv_笑哭]":"1abc628f6d4f4caf9d0e7800878f4697abbc8273.png","[tv_晕]":"5443c22b4d07fb1907ccc610c8e6db254f2461b7.png","[tv_点赞]":"f85c354995bd99e28fc76c869bfe42ba6438eff4.png","[tv_害羞]":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","[tv_睡着]":"8b196675b53af58264f383c50ad0945048290b33.png","[tv_色]":"61822c7e9aae5da76475e7892534545336b23a6f.png","[tv_吐血]":"09dd16a7aa59b77baa1155d47484409624470c77.png","[tv_无奈]":"ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png","[tv_再见]":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","[tv_流汗]":"cead1c351ab8d79e9f369605beb90148db0fbed3.png","[tv_偷笑]":"bb690d4107620f1c15cff29509db529a73aee261.png","[tv_抓狂]":"fe31c08edad661d63762b04e17b8d5ae3c71a757.png","[tv_黑人问号]":"45821a01f51bc867da9edbaa2e070410819a95b2.png","[tv_困]":"241ee304e44c0af029adceb294399391e4737ef2.png","[tv_打脸]":"56ab10b624063e966bfcb76ea5dc4794d87dfd47.png","[tv_闭嘴]":"c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png","[tv_鄙视]":"6e72339f346a692a495b123174b49e4e8e781303.png","[tv_腼腆]":"89712c0d4af73e67f89e35cbc518420380a7f6f4.png","[tv_馋]":"fc7e829b845c43c623c8b490ee3602b7f0e76a31.png","[tv_可爱]":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","[tv_发财]":"34db290afd2963723c6eb3c4560667db7253a21a.png","[tv_生病]":"8b0ec90e6b86771092a498c54f09fc94621c1900.png","[tv_流鼻血]":"c32d39db2737f89b904ca32700d140a9241b0767.png","[tv_尴尬]":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","[tv_大佬]":"093c1e2c490161aca397afc45573c877cdead616.png","[tv_流泪]":"7e71cde7858f0cd50d74b0264aa26db612a8a167.png","[tv_冷漠]":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","[tv_皱眉]":"72ccad6679fea0d14cce648b4d818e09b8ffea2d.png","[tv_鬼脸]":"0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png","[tv_调侃]":"4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png","[tv_目瞪口呆]":"0b8cb81a68de5d5365212c99375e7ace3e7891b7.png","[2233娘_大笑]":"16b8794be990cefa6caeba4d901b934a227ee3b8.png","[2233娘_疑问]":"0b41f509351958dbb63d472fec0132d1bd03bd14.png","[2233娘_吃惊]":"d1628c43d35b1530c0504a643ff80b6189fa0a43.png","[2233娘_汗]":"247cd9df8cdf84b18368c21e3b2dd374e84c0927.png","[2233娘_大哭]":"476a2a60f6e337b8c0697a592e0aa82781f6b33b.png","[2233娘_困惑]":"714eeb4eae0d0933b4ff08b7df788b1982f6b940.png","[2233娘_耶]":"d7178e258a0efc969b65ccc2b1322fb235f5dff4.png","[2233娘_怒]":"f31953119c51b9748016440ac0b632f779929b37.png","[2233娘_卖萌]":"ea893aa25355de95ab4f03c2dad3f0c58d0c159e.png","[2233娘_委屈]":"d9d0bf9d358af8d5761093ec66d4e3f60d963a63.png","[2233娘_郁闷]":"485203fe7100f2c8fc40b2800a18fe20b35f2f1a.png","[2233娘_第一]":"3754ee6e5985bd0bd7dfb668981f2a8733398ebd.png","[2233娘_喝水]":"695bf5429472049b52c1e0de586f8a2511195a23.png","[2233娘_吐魂]":"e999af499edf38a91ca68b1a9d2f97042c1d6734.png","[2233娘_无言]":"fdb5870f32cfaf7949e0f88a13f6feba4a48b719.png","[加油武汉]":"eb966aaa5b690d3f9308a9f936f5b5a72a7f956b.png","[口罩]":"3ad2f66b151496d2a5fb0a8ea75f32265d778dd3.png","[鸡腿]":"c7860392815d345fa69c4f00ef18d67dccfbd574.png","[微笑]":"685612eadc33f6bc233776c6241813385844f182.png","[笑]":"81edf17314cea3b48674312b4364df44d5c01f17.png","[呲牙]":"b5a5898491944a4268360f2e7a84623149672eb6.png","[OK]":"4683fd9ffc925fa6423110979d7dcac5eda297f4.png","[星星眼]":"63c9d1a31c0da745b61cdb35e0ecb28635675db2.png","[哦呼]":"362bded07ea5434886271d23fa25f5d85d8af06c.png","[嫌弃]":"de4c0783aaa60ec03de0a2b90858927bfad7154b.png","[喜欢]":"8a10a4d73a89f665feff3d46ca56e83dc68f9eb8.png","[酸了]":"92b1c8cbceea3ae0e8e32253ea414783e8ba7806.png","[大哭]":"2caafee2e5db4db72104650d87810cc2c123fc86.png","[害羞]":"9d2ec4e1fbd6cb1b4d12d2bbbdd124ccb83ddfda.png","[无语]":"44667b7d9349957e903b1b62cb91fb9b13720f04.png","[疑惑]":"b7840db4b1f9f4726b7cb23c0972720c1698d661.png","[调皮]":"8290b7308325e3179d2154327c85640af1528617.png","[喜极而泣]":"485a7e0c01c2d70707daae53bee4a9e2e31ef1ed.png","[奸笑]":"bb84906573472f0a84cebad1e9000eb6164a6f5a.png","[偷笑]":"6c49d226e76c42cd8002abc47b3112bc5a92f66a.png","[大笑]":"ca94ad1c7e6dac895eb5b33b7836b634c614d1c0.png","[阴险]":"ba8d5f8e7d136d59aab52c40fd3b8a43419eb03c.png","[捂脸]":"6921bb43f0c634870b92f4a8ad41dada94a5296d.png","[囧]":"12e41d357a9807cc80ef1e1ed258127fcc791424.png","[呆]":"33ad6000d9f9f168a0976bc60937786f239e5d8c.png","[抠鼻]":"cb89184c97e3f6d50acfd7961c313ce50360d70f.png","[惊喜]":"0afecaf3a3499479af946f29749e1a6c285b6f65.png","[惊讶]":"f8e9a59cad52ae1a19622805696a35f0a0d853f3.png","[笑哭]":"c3043ba94babf824dea03ce500d0e73763bf4f40.png","[妙啊]":"b4cb77159d58614a9b787b91b1cd22a81f383535.png","[doge]":"bba7c12aa51fed0199c241465560dfc2714c593e.png","[滑稽]":"d15121545a99ac46774f1f4465b895fe2d1411c3.png","[吃瓜]":"4191ce3c44c2b3df8fd97c33f85d3ab15f4f3c84.png ","[打call]":"431432c43da3ee5aab5b0e4f8931953e649e9975.png","[点赞]":"1a67265993913f4c35d15a6028a30724e83e7d35.png","[鼓掌]":"895d1fc616b4b6c830cf96012880818c0e1de00d.png  ","[尴尬]":"cb321684ed5ce6eacdc2699092ab8fe7679e4fda.png","[冷]":"cb0ebbd0668640f07ebfc0e03f7a18a8cd00b4ed.png","[灵魂出窍]":"43d3db7d97343c01b47e22cfabeca84b4251f35a.png","[委屈]":"d2f26cbdd6c96960320af03f5514c5b524990840.png","[傲娇]":"010540d0f61220a0db4922e4a679a1d8eca94f4e.png","[疼]":"905fd9a99ec316e353b9bd4ecd49a5f0a301eabf.png","[吓]":"9c10c5ebc7bef27ec641b8a1877674e0c65fea5d.png","[生病]":"0f25ce04ae1d7baf98650986454c634f6612cb76.png","[吐]":"06946bfe71ac48a6078a0b662181bb5cad09decc.png","[嘘声]":"e64af664d20716e090f10411496998095f62f844.png","[捂眼]":"c5c6d6982e1e53e478daae554b239f2b227b172b.png","[思考]":"cfa9b7e89e4bfe04bbcd34ccb1b0df37f4fa905c.png","[再见]":"fc510306bae26c9aec7e287cdf201ded27b065b9.png","[翻白眼]":"eba54707c7168925b18f6f8b1f48d532fe08c2b1.png","[哈欠]":"888d877729cbec444ddbd1cf4c9af155a7a06086.png","[奋斗]":"bb2060c15dba7d3fd731c35079d1617f1afe3376.png","[墨镜]":"3a03aebfc06339d86a68c2d893303b46f4b85771.png","[撇嘴]":"531863568e5668c5ac181d395508a0eeb1f0cda4.png","[难过]":"a651db36701610aa70a781fa98c07c9789b11543.png","[抓狂]":"4c87afff88c22439c45b79e9d2035d21d5622eba.png","[生气]":"3195714219c4b582a4fb02033dd1519913d0246d.png","[干杯]":"8da12d5f55a2c7e9778dcc05b40571979fe208e6.png","[爱心]":"ed04066ea7124106d17ffcaf75600700e5442f5c.png","[锦鲤]":"643d6c19c8164ffd89e3e9cdf093cf5d773d979c.png","[胜利]":"b49fa9f4b1e7c3477918153b82c60b114d87347c.png","[加油]":"c7aaeacb21e107292d3bb053e5abde4a4459ed30.png","[保佑]":"fafe8d3de0dc139ebe995491d2dac458a865fb30.png","[抱拳]":"89516218158dbea18ab78e8873060bf95d33bbbe.png","[响指]":"1b5c53cf14336903e1d2ae3527ca380a1256a077.png","[支持]":"3c210366a5585706c09d4c686a9d942b39feeb50.png","[拥抱]":"41780a4254750cdaaccb20735730a36044e98ef3.png","[怪我咯]":"07cc6077f7f7d75b8d2c722dd9d9828a9fb9e46d.png","[跪了]":"f2b3aee7e521de7799d4e3aa379b01be032698ac.png","[黑洞]":"e90ec4c799010f25391179118ccd9f66b3b279ba.png","[老鼠]":"8e6fb491eb1bb0d5862e7ec8ccf9a3da12b6c155.png","[2020]":"dc709fac0d361370bcf0d36d32adb97df7c95824.png","[福到了]":"5de5373d354c373cf1617b6b836f3a8d53c5a655.png"},
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="//lib.baomitu.com/jquery/3.5.1/jquery.min.js"></script><script src="https://myhkw.cn/api/player/159721473362" id="myhk" key="159721473362" m="1"></script><script src="https://cdn.jsdelivr.net/gh/stardust14/CDN/HexoStatic/js/Foster.js"></script><script src="https://cdn.jsdelivr.net/gh/stardust14/CDN/HexoStatic/js/hideCategory.min.js"></script><script src="https://cdn.jsdelivr.net/gh/stardust14/CDN/HexoStatic/js/title.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>